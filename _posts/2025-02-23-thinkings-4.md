---
title: '昇腾集群部署DeepSeek疯狂踩坑'
date: 2025-02-23
permalink: /posts/2025/02/thinking-4/
categories:
  - Tools
tags:
  - DeepSeek
  - Ascend
---


终于部署起来了，发现还是挺好用的。最近任务紧，等过几天闲下来写个踩坑记录。


<details>
<summary>原先的吐槽</summary>

<p>接到辅助学校部署DeepSeek的任务，很急。现在是凌晨1:10，是什么，让我忍不住要写这个笔记，我实在绷不住了啊！！！</p>
<h3>魔乐社区的奇妙体验</h3>
<p>我真傻，真的，我只知道魔乐社区下载很快，我只知道魔乐社区是华为推出的，应该很兼容，不知道这是一个多大的坑。</p>
<ul>
<li>魔乐社区下载工具不支持python3.11，但是华为MindIE官方镜像里的python是3.11
<ul>
<li>有人说，你装个python3.10不就行了吗？但是对不起，系统是华为自己的OpenEule，要装python自己编译。这任务火烧眉毛了还自己编译python呢.</li>
<li>有人说，你为什么不在宿主机下载，映射到容器里？我试了，魔乐社区的工具虽然下载到目标目录里，但是大文件是个软连接，都存储在<code>~/.cache</code>下，我在容器里根本读取不到。我好不容易配置好了容器还得重启一个改映射？？</li>
<li>有人说，他不是还支持git吗。很好，他需要git lfs。但是openeuler仓库的git-lfs没有引入到主线版本和正式版本中，只能自己找源码编译。</li>
</ul>
</li>
</ul>
<p>一切都回来了，想用的话，正反都要自己编译个软件先。</p>
<p>不是，我真的第一次见指定了目标下载地址，竟然给我整了个指向home目录的软链接？我要是home目录磁盘小了还装不下了？？？</p>
<h3>双机直连不可取</h3>
<p>我们搞了个两台昇腾服务器直连，显卡互相之间访问，这应该是最快的方法吧，就想着能算的快一点，大家用户体验好一点。</p>
<p>但是完全没想到的是，昇腾的多机多卡部署竟然需要每个显卡必须配置网关，直连根本没有网关。不是，你都能直连了，传就是了为啥要设置网关啊！！</p>
<p>程序不语，只是一味的报错。<strong>我真傻，真的。</strong></p>
<h3>时灵时不灵的自动部署工具</h3>
<p>本来我是想直接部署 <code>MindCluster</code>的，结果 A900T 在 OpenEuler_22.03LTS-SP4 上不支持<code>ascend-deployer</code>自动部署，给我整晕了，服务器是华为的、系统是华为的、部署工具也是华为的，加在一起咋不能用了……</p>

</details>



---

持续更新中......
